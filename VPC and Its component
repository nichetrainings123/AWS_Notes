<!-- README.md â€” VPC & Networking (GitHub-friendly HTML) -->

<h1>ğŸ”’ VPC & Networking Deep Dive</h1>

<p>
  <img src="https://img.shields.io/badge/AWS-Architecture-orange" alt="AWS"/>
  <img src="https://img.shields.io/badge/Network-Design-blue" alt="Network"/>
  <img src="https://img.shields.io/badge/Best%20Practices-âœ”ï¸-green" alt="Best Practices"/>
</p>

<p>
  An expanded, practical and copy-ready explanation of VPC, CIDR, subnets, routing, security groups, NAT, and the traffic flow in the example topology.
</p>

<hr />

<!-- Quick links -->
<p><strong>Contents:</strong>
  <a href="#vpc">VPC</a> Â·
  <a href="#cidr">CIDR</a> Â·
  <a href="#subnet">Subnet</a> Â·
  <a href="#igw">Internet Gateway</a> Â·
  <a href="#nat">NAT</a> Â·
  <a href="#route-table">Route Table</a> Â·
  <a href="#security-group">Security Group</a> Â·
  <a href="#nacl">NACL</a> Â·
  <a href="#p2p-p2s">P2P / P2S</a> Â·
  <a href="#elb">Load Balancer</a> Â·
  <a href="#diagram">Diagram & Flow</a> Â·
  <a href="#checklist">Checklist</a> Â·
  <a href="#glossary">Glossary</a>
</p>

<hr />

<details>
  <summary id="vpc"><strong>1. VPC â€” what it <em>really</em> is</strong> ğŸ”‘</summary>
  <p><strong>Definition:</strong> A VPC (Virtual Private Cloud) is an AWS-managed, logically isolated virtual network where you launch AWS resources (EC2, RDS, ECS, etc.). Think of it as your own private datacenter inside AWS.</p>

  <ul>
    <li><strong>Key properties:</strong> CIDR block (e.g., <code>10.0.0.0/16</code>), spans AZs, contains subnets, route tables, and security controls.</li>
    <li><strong>Best practices:</strong> Use separate VPCs/accounts for <em>prod</em>, <em>staging</em>, and <em>dev</em>. Design for multi-AZ and least-privilege networking.</li>
    <li><strong>Example:</strong> VPC CIDR: <code>10.0.0.0/16</code></li>
  </ul>
</details>

<details>
  <summary id="cidr"><strong>2. CIDR â€” addressing & sizing</strong> ğŸ“</summary>
  <p><strong>Format:</strong> <code>IP/prefix</code> e.g. <code>10.0.0.0/16</code>.</p>

  <ul>
    <li><code>/16</code> â†’ 65,536 IPs (10.0.0.0â€“10.0.255.255)</li>
    <li><code>/24</code> â†’ 256 IPs (10.0.1.0â€“10.0.1.255)</li>
    <li><strong>AWS detail:</strong> AWS reserves <strong>5 IPs</strong> per subnet (first 4 and last 1).</li>
    <li><strong>Design tip:</strong> Avoid overly large blocks and overlapping ranges if you plan VPNs/peering.</li>
  </ul>
</details>

<details>
  <summary id="subnet"><strong>3. Subnet â€” AZ-level slices</strong> ğŸ—‚ï¸</summary>
  <p>Each subnet belongs to a single AZ.</p>

  <p><strong>Types:</strong></p>
  <ul>
    <li><strong>Public subnet</strong>: route to IGW, instances usually have public/elastic IPs.</li>
    <li><strong>Private subnet</strong>: no direct IGW; uses NAT for outbound internet access.</li>
  </ul>

  <p><strong>Example mapping:</strong> VPC <code>10.0.0.0/16</code> â†’ public <code>10.0.1.0/24</code>, private <code>10.0.2.0/24</code>.</p>
</details>

<details>
  <summary id="igw"><strong>4. Internet Gateway (IGW)</strong> ğŸŒ</summary>
  <p><strong>Purpose:</strong> Connects the VPC to the Internet. Requirements for public access:</p>
  <ol>
    <li>Route table entry: <code>0.0.0.0/0 â†’ igw-...</code></li>
    <li>Instance with public (or Elastic) IP.</li>
    <li>Security Group / NACL allowing traffic.</li>
  </ol>
  <p><strong>Note:</strong> One IGW per VPC; attach it explicitly.</p>
</details>

<details>
  <summary id="nat"><strong>5. NAT â€” private instances reaching the internet</strong> ğŸ”</summary>
  <p><strong>NAT Gateway</strong> (recommended): AWS-managed, highly available per AZ (create one per AZ for HA). Requires an Elastic IP and is charged hourly + data processed.</p>

  <p><strong>NAT Instance</strong>: EC2-based, requires maintenance and HA design â€” use only if you need custom behavior.</p>

  <pre><code>Private EC2 â†’ NAT Gateway (in Public Subnet) â†’ IGW â†’ Internet</code></pre>
</details>

<details>
  <summary id="route-table"><strong>6. Route Table â€” where traffic is directed</strong> ğŸ§­</summary>
  <p>A route table contains rules mapping destination CIDRs to targets (local, IGW, NAT, VPC peering, TGW, endpoints).</p>

  <p><strong>Common entries:</strong></p>
  <ul>
    <li><code>10.0.0.0/16 â†’ local</code> (auto)</li>
    <li>Public RT: <code>0.0.0.0/0 â†’ igw-...</code></li>
    <li>Private RT: <code>0.0.0.0/0 â†’ nat-...</code></li>
  </ul>
</details>

<details>
  <summary id="security-group"><strong>7. Security Group (SG) â€” instance-level firewall</strong> ğŸ”</summary>
  <p>Stateful, allow-only rules. Attach to ENIs or instances and edit at runtime.</p>

  <p><strong>Example Web SG:</strong></p>
  <pre><code>Inbound:
  - TCP 80,443 from 0.0.0.0/0
Outbound:
  - All (or restricted per policy)</code></pre>

  <p><strong>Recommendation:</strong> Lock SSH (<code>22</code>) to administrative IPs or use SSM Session Manager instead of public SSH.</p>
</details>

<details>
  <summary id="nacl"><strong>8. Network ACL (NACL) â€” subnet-level firewall</strong> ğŸš§</summary>
  <p>Stateless. Order-based rules; can explicitly allow or deny traffic. Use as an extra layer (e.g., emergency block or edge filtering).</p>

  <p><strong>Example:</strong></p>
  <pre><code>Inbound:
  - Rule 100: ALLOW TCP 80  from 0.0.0.0/0
  - Rule 110: DENY  TCP 22  from 0.0.0.0/0
Outbound:
  - (matching allow rules for return traffic)</code></pre>
</details>

<details>
  <summary id="p2p-p2s"><strong>9â€“10. P2P (Peering/DirectConnect) & P2S (Client VPN)</strong> ğŸ”—</summary>
  <p><strong>VPC Peering:</strong> Connect 2 VPCs (not transitive). Good for one-to-one or few VPC connections.</p>
  <p><strong>Direct Connect:</strong> Dedicated physical link from on-prem â†’ AWS for predictable bandwidth and lower latency.</p>
  <p><strong>Transit Gateway:</strong> Use for large-scale multi-VPC networks (supports transitive routing).</p>

  <p><strong>Client VPN / P2S</strong> â€” AWS Client VPN allows laptops and admins to connect securely to private resources without public IPs.</p>
</details>

<details>
  <summary id="elb"><strong>11. Load Balancer (ELB family)</strong> âš–ï¸</summary>
  <p><strong>ALB (Application LB):</strong> Layer 7, path & host-based routing, WebSocket and HTTP/2 support â€” ideal for microservices.</p>
  <p><strong>NLB (Network LB):</strong> Layer 4, ultra-low latency, high throughput â€” preserves client IPs.</p>
  <p><strong>CLB (Classic LB):</strong> Legacy; use only for legacy apps.</p>
</details>

<hr />

<h2 id="diagram">ğŸ“ˆ Example topology & traffic flow</h2>

<pre><code>
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚        AWS Region            â”‚
                â”‚   (Virtual Private Cloud)    â”‚
                â”‚  CIDR: 10.0.0.0/16           â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                                 â”‚
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ Public Subnet â”‚ 10.0.1.0/24     â”‚ Private Subnetâ”‚ 10.0.2.0/24
 â”‚   (AZ-A)      â”‚                 â”‚   (AZ-A)      â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                 â”‚
  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
  â”‚  EC2 (Web) â”‚                   â”‚  EC2 (DB)   â”‚
  â”‚ Public IP  â”‚                   â”‚ Private IP  â”‚
  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚                                 â”‚
   â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                     â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
   â”‚   IGW     â”‚                     â”‚   NAT GW  â”‚
   â”‚ Internet  â”‚                     â”‚ Outbound  â”‚
   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚                                 â”‚
 â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚ Public RT      â”‚                â”‚ Private RT     â”‚
 â”‚----------------â”‚                â”‚----------------â”‚
 â”‚ Local:10.0.0.0 â”‚                â”‚ Local:10.0.0.0 â”‚
 â”‚ IGW: 0.0.0.0/0 â”‚                â”‚ NAT: 0.0.0.0/0 â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>

<p><strong>Flow walkthrough:</strong></p>
<ol>
  <li>Client â†’ Internet â†’ IGW (DNS resolves to ALB or EC2 public IP)</li>
  <li>IGW â†’ Public RT â†’ EC2 (Web) (instance must have a public IP & SG to allow HTTP/HTTPS)</li>
  <li>Web â†’ DB via private IP (stays inside VPC)</li>
  <li>DB (private subnet) needs outbound access? â†’ Private RT â†’ NAT Gateway â†’ IGW â†’ Internet</li>
</ol>

<hr />

<h2 id="checklist">âœ… Quick deployment checklist</h2>

<table>
  <thead>
    <tr><th>Step</th><th>Example/Notes</th></tr>
  </thead>
  <tbody>
    <tr><td>Choose VPC CIDR</td><td><code>10.10.0.0/16</code></td></tr>
    <tr><td>Create subnets per AZ</td><td>Public <code>10.10.1.0/24</code>, Private <code>10.10.2.0/24</code> (replicate per AZ)</td></tr>
    <tr><td>Create IGW & attach</td><td>One IGW per VPC</td></tr>
    <tr><td>Create NAT Gateway(s)</td><td>One per AZ for HA â€” requires EIP</td></tr>
    <tr><td>Create route tables</td><td>Public RT -> IGW; Private RT -> NAT GW</td></tr>
    <tr><td>Security Groups</td><td>ALB SG allow 80/443; Web SG allow from ALB; DB SG allow from Web SG only</td></tr>
    <tr><td>VPC endpoints</td><td>Add S3/DynamoDB endpoints to avoid internet egress</td></tr>
    <tr><td>Monitoring</td><td>Enable VPC Flow Logs + CloudWatch + CloudTrail</td></tr>
  </tbody>
</table>

<hr />

<h2 id="glossary">ğŸ“š Glossary</h2>
<table>
  <thead><tr><th>Term</th><th>Meaning</th></tr></thead>
  <tbody>
    <tr><td>ENI</td><td>Elastic Network Interface (virtual NIC)</td></tr>
    <tr><td>EIP</td><td>Elastic IP (public static IP)</td></tr>
    <tr><td>VGW</td><td>Virtual Private Gateway â€” used for VPN/Direct Connect</td></tr>
    <tr><td>Transit Gateway</td><td>Hub for connecting many VPCs & VPNs</td></tr>
  </tbody>
</table>

<hr />

<details>
  <summary><strong>Terraform & AWS CLI starter snippets</strong> ğŸ› ï¸</summary>

  <p><strong>AWS CLI â€” create VPC and subnet (example)</strong></p>
  <pre><code>aws ec2 create-vpc --cidr-block 10.10.0.0/16
aws
